{
  "validator": {
    "$jsonSchema": {
      "bsonType": "object",
      "required": [
        "tokenHash",
        "user_id",
        "expiresAt",
        "createdAt"
      ],
      "properties": {
        "tokenHash": {
          "bsonType": "string"
        },
        "user_id": {
          "bsonType": "objectId"
        },
        "expiresAt": {
          "bsonType": "date"
        },
        "createdAt": {
          "bsonType": "date"
        },
        "used": {
          "bsonType": "bool"
        }
      }
    }
  }
}